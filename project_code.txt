=== Django Project Export ===
Root: C:\OnlineShop


==================== START FILE: manage.py ====================
#!/usr/bin/env python
"""Django's command-line utility for administrative tasks."""
import os
import sys


def main():
    """Run administrative tasks."""
    os.environ.setdefault('DJANGO_SETTINGS_MODULE', 'my_shop.settings')
    try:
        from django.core.management import execute_from_command_line
    except ImportError as exc:
        raise ImportError(
            "Couldn't import Django. Are you sure it's installed and "
            "available on your PYTHONPATH environment variable? Did you "
            "forget to activate a virtual environment?"
        ) from exc
    execute_from_command_line(sys.argv)


if __name__ == '__main__':
    main()

==================== END FILE: manage.py ====================

==================== START FILE: project_code.txt ====================

==================== END FILE: project_code.txt ====================

==================== START FILE: core\admin.py ====================
from django.contrib import admin
from django.contrib.auth.admin import UserAdmin
from .models import User, Product, ProductImage, Order, Category, OrderStatusHistory

# å¯ç”¨å¤šå›¾ä¸Šä¼ ç•Œé¢ (Block B1)
class ProductImageInline(admin.TabularInline):
    model = ProductImage
    extra = 1

@admin.register(Product)
class ProductAdmin(admin.ModelAdmin):
    list_display = ('id', 'name', 'price', 'stock_quantity', 'is_active')
    search_fields = ('name', 'id') # A15: å…è®¸æŒ‰åç§°å’Œ ID æœç´¢
    # åœ¨ç¼–è¾‘å•†å“æ—¶ï¼Œç›´æ¥å¯ä»¥åœ¨ä¸‹é¢æ·»åŠ å¤šå¼ å›¾ç‰‡
    inlines = [ProductImageInline]

class OrderStatusInline(admin.TabularInline):
    model = OrderStatusHistory
    extra = 0
    readonly_fields = ('changed_at',)

@admin.register(Order)
class OrderAdmin(admin.ModelAdmin):
    # Block B3: å…è®¸æŒ‰çŠ¶æ€è¿‡æ»¤
    list_filter = ('status', 'created_at')
    list_display = ('id', 'user', 'total_amount', 'status', 'created_at')
    # åœ¨è®¢å•è¯¦æƒ…é‡Œæ˜¾ç¤ºçŠ¶æ€å˜æ›´å†å² (Block B4)
    inlines = [OrderStatusInline]

# æ³¨å†Œå…¶ä»–æ¨¡å‹
# ä½¿ç”¨ UserAdmin æ¥ç®¡ç†è‡ªå®šä¹‰ç”¨æˆ·ï¼Œè¿™æ ·åå°ä¸ä»…èƒ½ç®¡ç†ç”¨æˆ·ï¼Œè¿˜èƒ½ä¿ç•™ä¿®æ”¹å¯†ç ç­‰åŠŸèƒ½
@admin.register(User)
class CustomUserAdmin(UserAdmin):
    fieldsets = UserAdmin.fieldsets + (
        (None, {'fields': ('role',)}),
    )
    add_fieldsets = UserAdmin.add_fieldsets + (
        (None, {'fields': ('role',)}),
    )
    list_display = UserAdmin.list_display + ('role',)
    list_filter = UserAdmin.list_filter + ('role',)

admin.site.register(Category)
==================== END FILE: core\admin.py ====================

==================== START FILE: core\apps.py ====================
from django.apps import AppConfig


class CoreConfig(AppConfig):
    default_auto_field = 'django.db.models.BigAutoField'
    name = 'core'

==================== END FILE: core\apps.py ====================

==================== START FILE: core\context_processors.py ====================
from .models import Cart

def cart_status(request):
    """
    è¿™ä¸ªå‡½æ•°ä¼šåœ¨æ¯ä¸ªé¡µé¢åŠ è½½æ—¶è¿è¡Œï¼Œ
    ä¸“é—¨è´Ÿè´£è®¡ç®—è´­ç‰©è½¦é‡Œæœ‰å¤šå°‘ä»¶å•†å“ã€‚
    """
    count = 0
    if request.user.is_authenticated:
        # è·å–ç”¨æˆ·çš„è´­ç‰©è½¦
        cart = Cart.objects.filter(user=request.user).first()
        if cart:
            # æŠŠæ¯ä¸€é¡¹çš„æ•°é‡åŠ èµ·æ¥ (æ¯”å¦‚ä¹°äº†2ä¸ªè‹¹æœï¼Œ3ä¸ªæ¢¨ï¼Œæ€»æ•°æ˜¯5)
            for item in cart.cartitem_set.all():
                count += item.quantity
    
    # è¿”å›ç»™æ¨¡æ¿ï¼Œå˜é‡åå« cart_item_count
    return {'cart_item_count': count}
==================== END FILE: core\context_processors.py ====================

==================== START FILE: core\forms.py ====================
from django import forms
from django.contrib.auth.forms import UserCreationForm
from django.contrib.auth import get_user_model

# è·å–å½“å‰é¡¹ç›®å®é™…ä½¿ç”¨çš„ç”¨æˆ·æ¨¡å‹ï¼ˆå³ core.Userï¼‰
User = get_user_model()

class CustomUserCreationForm(UserCreationForm):
    # æ·»åŠ è¿™äº›å­—æ®µè®©ç”¨æˆ·åœ¨æ³¨å†Œæ—¶å¡«å†™
    email = forms.EmailField(required=True, label="Email Address")
    full_name = forms.CharField(required=True, label="Full Name")
    address = forms.CharField(required=True, label="Shipping Address", widget=forms.Textarea(attrs={'rows': 3}))
    city = forms.CharField(required=True, label="City")
    class Meta:
        model = User
        # æŒ‡å®šè¡¨å•ä¸­æ˜¾ç¤ºçš„å­—æ®µ
        fields = ("username", "email", "full_name")

    def save(self, commit=True):
        user = super().save(commit=False)
        user.email = self.cleaned_data["email"]
        user.full_name = self.cleaned_data["full_name"]
        if commit:
            user.save()
            from .models import Address
            Address.objects.create(
                user=user,
                recipient_name=user.full_name,
                address_line1=self.cleaned_data["address"],
                city=self.cleaned_data["city"],
                zip_code="000000", # ç®€åŒ–å¤„ç†ï¼Œæˆ–è®©ç”¨æˆ·å¡«
                country="Macau"
            )
        return user
==================== END FILE: core\forms.py ====================

==================== START FILE: core\models.py ====================
from django.db import models
from django.contrib.auth.models import AbstractUser

# ==========================================
# 1. ç”¨æˆ·ç®¡ç† (Block A & Block W)
# ==========================================
class User(AbstractUser):
    """
    ç»§æ‰¿ Django è‡ªå¸¦çš„ AbstractUserï¼Œè‡ªå¸¦äº†ç™»å½•ã€æ³¨å†Œã€å¯†ç åŠ å¯†åŠŸèƒ½ã€‚
    æˆ‘ä»¬åªéœ€è¦æ·»åŠ é¢å¤–çš„è§’è‰²å­—æ®µã€‚
    """
    class Role(models.TextChoices):
        CUSTOMER = 'Customer', 'é¡¾å®¢'
        ADMIN = 'Admin', 'ç®¡ç†å‘˜/å•†å®¶'

    role = models.CharField(
        max_length=20,
        choices=Role.choices,
        default=Role.CUSTOMER,
        verbose_name="ç”¨æˆ·è§’è‰²"
    )

class Address(models.Model):
    """ç”¨æˆ·æ”¶è´§åœ°å€"""
    user = models.ForeignKey(User, on_delete=models.CASCADE, related_name='addresses')
    recipient_name = models.CharField("æ”¶ä»¶äºº", max_length=100)
    address_line1 = models.CharField("è¯¦ç»†åœ°å€", max_length=255)
    city = models.CharField("åŸå¸‚", max_length=100)
    zip_code = models.CharField("é‚®ç¼–", max_length=20)
    country = models.CharField("å›½å®¶", max_length=100)
    is_default = models.BooleanField("é»˜è®¤åœ°å€", default=False)

    def __str__(self):
        return f"{self.recipient_name} - {self.city}"

# ==========================================
# 2. å•†å“ç›®å½• (Block A & Block B & Block C)
# ==========================================
class Category(models.Model):
    """å•†å“åˆ†ç±»ï¼Œæ”¯æŒæ— é™å±‚çº§"""
    name = models.CharField("åˆ†ç±»åç§°", max_length=100)
    parent = models.ForeignKey('self', on_delete=models.CASCADE, null=True, blank=True, related_name='children')

    def __str__(self):
        return self.name

class Product(models.Model):
    """å•†å“æ ¸å¿ƒä¿¡æ¯"""
    category = models.ForeignKey(Category, on_delete=models.CASCADE, related_name='products')
    name = models.CharField("å•†å“åç§°", max_length=200)
    # Block C1: æ”¯æŒ HTML çš„è¯¦ç»†æè¿°
    description_html = models.TextField("å•†å“è¯¦æƒ…(HTML)", help_text="æ”¯æŒ HTML æ ¼å¼")
    price = models.DecimalField("ä»·æ ¼", max_digits=10, decimal_places=2)
    stock_quantity = models.PositiveIntegerField("åº“å­˜", default=0)
    # Block A18: å•†å®¶å¯ä»¥ä¸‹æ¶å•†å“
    is_active = models.BooleanField("æ˜¯å¦ä¸Šæ¶", default=True)
    created_at = models.DateTimeField(auto_now_add=True)

    def __str__(self):
        return self.name

class ProductImage(models.Model):
    """
    Block B1: æ”¯æŒä¸€ä¸ªå•†å“å¯¹åº”å¤šå¼ å›¾ç‰‡
    """
    product = models.ForeignKey(Product, on_delete=models.CASCADE, related_name='images')
    # å›¾ç‰‡ä¼šä¸Šä¼ åˆ° media/product_images/ æ–‡ä»¶å¤¹
    image = models.ImageField("å›¾ç‰‡æ–‡ä»¶", upload_to='product_images/')
    is_primary = models.BooleanField("æ˜¯å¦ä¸»å›¾", default=False)

    def __str__(self):
        return f"Image for {self.product.name}"

class ProductAttribute(models.Model):
    """
    Block C2: å•†å“åŠ¨æ€å±æ€§ï¼ˆå¦‚æè´¨ã€CPUå‹å·ï¼‰
    """
    product = models.ForeignKey(Product, on_delete=models.CASCADE, related_name='attributes')
    attribute_name = models.CharField("å±æ€§å", max_length=50)
    attribute_value = models.CharField("å±æ€§å€¼", max_length=100)

# ==========================================
# 3. è´­ç‰©è½¦ (Block A7-A10)
# ==========================================
class Cart(models.Model):
    """è´­ç‰©è½¦ä¸»è¡¨"""
    user = models.OneToOneField(User, on_delete=models.CASCADE, related_name='cart')
    updated_at = models.DateTimeField(auto_now=True)

    def __str__(self):
        return f"Cart for {self.user.username}"

class CartItem(models.Model):
    """è´­ç‰©è½¦æ˜ç»†"""
    cart = models.ForeignKey(Cart, on_delete=models.CASCADE)
    product = models.ForeignKey(Product, on_delete=models.CASCADE)
    quantity = models.PositiveIntegerField(default=1)

    def __str__(self):
        return f"{self.quantity} x {self.product.name}"

# ==========================================
# 4. è®¢å•ç³»ç»Ÿ (Block A & Block B)
# ==========================================
class Order(models.Model):
    """è®¢å•ä¸»è¡¨"""
    # Block B2: å®šä¹‰è‡³å°‘4ç§çŠ¶æ€
    class Status(models.TextChoices):
        PENDING = 'Pending', 'å¾…å‘è´§'
        SHIPPED = 'Shipped', 'å·²å‘è´§'
        CANCELLED = 'Cancelled', 'å·²å–æ¶ˆ'
        HOLD = 'Hold', 'æš‚åœå¤„ç†'
        REFUNDED = 'Refunded', 'å·²é€€æ¬¾'

    user = models.ForeignKey(User, on_delete=models.CASCADE, related_name='orders')
    total_amount = models.DecimalField("æ€»é‡‘é¢", max_digits=10, decimal_places=2)
    # 3NF: ä¿å­˜ä¸‹å•æ—¶çš„åœ°å€å¿«ç…§
    shipping_address_snapshot = models.TextField("æ”¶è´§åœ°å€å¿«ç…§")
    status = models.CharField("è®¢å•çŠ¶æ€", max_length=20, choices=Status.choices, default=Status.PENDING)
    created_at = models.DateTimeField("ä¸‹å•æ—¶é—´", auto_now_add=True)
    
    def save(self, *args, **kwargs):
        # æ£€æŸ¥æ˜¯å¦æ˜¯æ›´æ–°ï¼ˆæœ‰ PKï¼‰
        if self.pk:
            old_order = Order.objects.get(pk=self.pk)
            if old_order.status != self.status:
                # çŠ¶æ€å˜äº†ï¼Œåˆ›å»ºå†å²è®°å½•
                OrderStatusHistory.objects.create(
                    order=self,
                    status=self.status,
                    comments=f"Status changed from {old_order.status} to {self.status}"
                )
        super().save(*args, **kwargs)

    def __str__(self):
        return f"Order #{self.id} - {self.user.username}"

class OrderItem(models.Model):
    """è®¢å•é‡Œçš„å…·ä½“å•†å“"""
    order = models.ForeignKey(Order, on_delete=models.CASCADE, related_name='items')
    product = models.ForeignKey(Product, on_delete=models.SET_NULL, null=True)
    product_name_snapshot = models.CharField("å•†å“åå¿«ç…§", max_length=200)
    quantity = models.PositiveIntegerField("æ•°é‡", default=1)
    unit_price_snapshot = models.DecimalField("å•ä»·å¿«ç…§", max_digits=10, decimal_places=2)

class OrderStatusHistory(models.Model):
    """
    Block B4: è®°å½•è®¢å•çŠ¶æ€å˜æ›´çš„æ—¶é—´
    """
    order = models.ForeignKey(Order, on_delete=models.CASCADE, related_name='status_history')
    status = models.CharField("çŠ¶æ€", max_length=20)
    changed_at = models.DateTimeField("å˜æ›´æ—¶é—´", auto_now_add=True)
    comments = models.TextField("å¤‡æ³¨", blank=True, null=True)

# ==========================================
# 5. ç”¨æˆ·ç”Ÿæˆå†…å®¹ (Block T) -- ä¹‹å‰ç¼ºå¤±çš„éƒ¨åˆ†
# ==========================================
class Review(models.Model):
    """
    Block T: å•†å“è¯„ä»·ä¸è¯„åˆ†
    """
    product = models.ForeignKey(Product, on_delete=models.CASCADE, related_name='reviews')
    user = models.ForeignKey(User, on_delete=models.CASCADE, related_name='reviews')
    # é™åˆ¶è¯„åˆ†åªèƒ½æ˜¯ 1-5
    rating = models.IntegerField("è¯„åˆ†", choices=[(i, str(i)) for i in range(1, 6)])
    comment = models.TextField("è¯„è®ºå†…å®¹", blank=True, null=True)
    created_at = models.DateTimeField(auto_now_add=True)

    def __str__(self):
        return f"Review by {self.user.username} on {self.product.name}"
==================== END FILE: core\models.py ====================

==================== START FILE: core\tests.py ====================
from django.test import TestCase

# Create your tests here.

==================== END FILE: core\tests.py ====================

==================== START FILE: core\urls.py ====================
from django.urls import path
from django.contrib.auth import views as auth_views
from . import views
from django.db import transaction

# å‘½åç©ºé—´
app_name = 'core'

urlpatterns = [
    # ==============================
    # 1. å•†å“æµè§ˆ (Block A & B)
    # ==============================
    path('', views.product_list, name='product_list'),
    path('product/<int:pk>/', views.product_detail, name='product_detail'),

    # ==============================
    # 2. ç”¨æˆ·è®¤è¯ (Block A1-A2)
    # ==============================
    path('login/', auth_views.LoginView.as_view(template_name='core/login.html'), name='login'),
    path('logout/', auth_views.LogoutView.as_view(next_page='core:product_list'), name='logout'),
    path('register/', views.register, name='register'),

    # ==============================
    # 3. è´­ç‰©è½¦ (Block A7-A10)
    # ==============================
    path('cart/', views.cart_detail, name='cart_detail'),
    path('cart/add/<int:product_id>/', views.add_to_cart, name='add_to_cart'),
    path('cart/remove/<int:item_id>/', views.remove_from_cart, name='remove_from_cart'),

    # ==============================
    # 4. è®¢å•ç³»ç»Ÿ (Block A11-A13) -- è¿™å°±æ˜¯ä½ ç¼ºå¤±çš„éƒ¨åˆ†ï¼
    # ==============================
    # ç»“ç®—åŠ¨ä½œ (å¯¹åº” cart_detail.html é‡Œçš„æŒ‰é’®)
    path('checkout/', views.checkout, name='checkout'),
    # è®¢å•å†å²
    path('orders/', views.order_list, name='order_list'),
    # è®¢å•è¯¦æƒ…
    path('orders/<int:pk>/', views.order_detail, name='order_detail'),
    path('cart/update/<int:item_id>/', views.update_cart_quantity, name='update_cart_quantity'),
]

==================== END FILE: core\urls.py ====================

==================== START FILE: core\views.py ====================
from django.shortcuts import render, get_object_or_404, redirect
from django.contrib.auth import login
# from django.contrib.auth.forms import UserCreationForm  <-- è¿™è¡Œå·²ç»è¢«æˆ‘ä»¬åºŸå¼ƒäº†
from django.contrib.auth.decorators import login_required
from django.db.models import Q
from django.db import transaction
from .models import Product, Category, Cart, CartItem, Order, OrderItem
from django.core.paginator import Paginator

# ã€æ”¹åŠ¨ç‚¹ 1ã€‘å¼•å…¥æˆ‘ä»¬åœ¨ core/forms.py é‡Œå†™çš„è‡ªå®šä¹‰è¡¨å•
from .forms import CustomUserCreationForm

# ==============================
# 1. å•†å“æµè§ˆ (Block A & C)
# ==============================

def product_list(request):
    """
    Block A3 & A4: å•†å“åˆ—è¡¨é¡µ + æœç´¢ + åˆ†é¡µ (Block A5)
    """
    query = request.GET.get('q')
    category_id = request.GET.get('category')
    
    # 1. è·å–æ‰€æœ‰ç¬¦åˆæ¡ä»¶çš„å•†å“
    products_list = Product.objects.filter(is_active=True).order_by('-created_at') # å»ºè®®åŠ æ’åºï¼Œå¦åˆ™åˆ†é¡µå¯èƒ½ä¼šä¹±

    if query:
        products_list = products_list.filter(
            Q(name__icontains=query) | 
            Q(description_html__icontains=query)
        )
    
    if category_id:
        products_list = products_list.filter(category_id=category_id)

    # 2. ã€æ ¸å¿ƒä¿®æ”¹ã€‘åˆ†é¡µé€»è¾‘
    # Paginator(æ•°æ®æº, æ¯é¡µæ•°é‡)
    # è¿™é‡Œè®¾ç½®ä¸º 6ï¼Œæ„å‘³ç€å¦‚æœä½ æœ‰ 7 ä¸ªå•†å“ï¼Œå°±ä¼šå‡ºç°ç¬¬ 2 é¡µ
    paginator = Paginator(products_list, 6) 
    
    page_number = request.GET.get('page') # ä»ç½‘å€ ?page=X ä¸­è·å–é¡µç 
    page_obj = paginator.get_page(page_number) # è·å–é‚£ä¸€é¡µçš„å…·ä½“æ•°æ®

    context = {
        'products': page_obj, # æ³¨æ„ï¼šè¿™é‡Œä¼ çš„æ˜¯ page_objï¼Œä¸å†æ˜¯åŸæœ¬çš„ products_list
        'categories': Category.objects.all()
    }
    return render(request, 'core/product_list.html', context)

def product_detail(request, pk):
    """
    Block A6: å•†å“è¯¦æƒ…é¡µ
    """
    product = get_object_or_404(Product, pk=pk, is_active=True)
    return render(request, 'core/product_detail.html', {'product': product})

# ==============================
# 2. ç”¨æˆ·æ³¨å†Œ (Block A1)
# ==============================

def register(request):
    if request.method == 'POST':
        # ã€æ”¹åŠ¨ç‚¹ 2ã€‘è¿™é‡Œæ”¹æˆäº† CustomUserCreationForm
        form = CustomUserCreationForm(request.POST)
        if form.is_valid():
            user = form.save()
            # æ³¨å†ŒæˆåŠŸåç›´æ¥ç™»å½•
            login(request, user)
            return redirect('core:product_list')
    else:
        # ã€æ”¹åŠ¨ç‚¹ 3ã€‘è¿™é‡Œä¹Ÿæ”¹æˆäº† CustomUserCreationForm
        form = CustomUserCreationForm()
    return render(request, 'core/register.html', {'form': form})

# ==============================
# 3. è´­ç‰©è½¦é€»è¾‘ (Block A7-A10)
# ==============================

@login_required(login_url='core:login')
def add_to_cart(request, product_id):
    """
    Block A7: æ·»åŠ åˆ°è´­ç‰©è½¦
    """
    product = get_object_or_404(Product, id=product_id)
    cart, created = Cart.objects.get_or_create(user=request.user)
    cart_item, item_created = CartItem.objects.get_or_create(cart=cart, product=product)
    
    if request.method == 'POST':
        quantity = int(request.POST.get('quantity', 1))
        if not item_created:
            cart_item.quantity += quantity
        else:
            cart_item.quantity = quantity
    else:
        if not item_created:
            cart_item.quantity += 1
            
    cart_item.save()
    cart.save()
    
    return redirect('core:cart_detail')

@login_required(login_url='core:login')
def cart_detail(request):
    """
    Block A8: æŸ¥çœ‹è´­ç‰©è½¦
    """
    cart, created = Cart.objects.get_or_create(user=request.user)
    cart_items = cart.cartitem_set.all()
    
    total_price = 0
    for item in cart_items:
        item.subtotal = item.product.price * item.quantity
        total_price += item.subtotal
        
    context = {
        'cart_items': cart_items,
        'total_price': total_price
    }
    return render(request, 'core/cart_detail.html', context)

@login_required(login_url='core:login')
def remove_from_cart(request, item_id):
    """
    Block A10: ä»è´­ç‰©è½¦ç§»é™¤å•†å“
    """
    cart_item = get_object_or_404(CartItem, id=item_id, cart__user=request.user)
    cart_item.delete()
    return redirect('core:cart_detail')

# ==============================
# 4. è®¢å•ç³»ç»Ÿ (Block A11-A13)
# ==============================

@login_required(login_url='core:login')
def checkout(request):
    """
    Block A11: ç»“ç®—æµç¨‹
    """
    cart, _ = Cart.objects.get_or_create(user=request.user)
    cart_items = cart.cartitem_set.all()
    
    if not cart_items.exists():
        return redirect('core:product_list')

    total_amount = 0
    for item in cart_items:
        total_amount += item.product.price * item.quantity

    with transaction.atomic():
        address_snapshot = "ç”¨æˆ·é»˜è®¤æ”¶è´§åœ°å€"
        if request.user.addresses.exists():
            addr = request.user.addresses.first()
            address_snapshot = f"{addr.recipient_name}, {addr.address_line1}, {addr.city}"

        order = Order.objects.create(
            user=request.user,
            total_amount=total_amount,
            shipping_address_snapshot=address_snapshot,
            status=Order.Status.PENDING
        )

        for item in cart_items:
            OrderItem.objects.create(
                order=order,
                product=item.product,
                product_name_snapshot=item.product.name,
                unit_price_snapshot=item.product.price,
                quantity=item.quantity
            )
        
        cart_items.delete()

    return redirect('core:order_detail', pk=order.id)

@login_required(login_url='core:login')
def order_list(request):
    """Block A12: è®¢å•å†å²åˆ—è¡¨"""
    orders = Order.objects.filter(user=request.user).order_by('-created_at')
    return render(request, 'core/order_list.html', {'orders': orders})

@login_required(login_url='core:login')
def order_detail(request, pk):
    """Block A13: è®¢å•è¯¦æƒ…"""
    order = get_object_or_404(Order, pk=pk, user=request.user)
    return render(request, 'core/order_detail.html', {'order': order})
@login_required(login_url='core:login')
def update_cart_quantity(request, item_id):
    if request.method == 'POST':
        quantity = int(request.POST.get('quantity'))
        cart_item = get_object_or_404(CartItem, id=item_id, cart__user=request.user)
        if quantity > 0:
            cart_item.quantity = quantity
            cart_item.save()
        else:
            cart_item.delete()
    return redirect('core:cart_detail')
==================== END FILE: core\views.py ====================

==================== START FILE: core\__init__.py ====================

==================== END FILE: core\__init__.py ====================

==================== START FILE: core\templates\core\base.html ====================
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>My Online Shop</title>
    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <style>
        .product-card img { height: 200px; object-fit: cover; }
    </style>
</head>
<body>
    <!-- Navbar -->
    <nav class="navbar navbar-expand-lg navbar-dark bg-dark mb-4">
        <div class="container">
            <a class="navbar-brand" href="{% url 'core:product_list' %}">ğŸ›’ Online Shop</a>
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navbarNav">
                <ul class="navbar-nav me-auto">
                    <li class="nav-item"><a class="nav-link" href="{% url 'core:product_list' %}">Home</a></li>
                </ul>
                <!-- Search Form -->
                <form class="d-flex" method="get" action="{% url 'core:product_list' %}">
                    <input class="form-control me-2" type="search" name="q" placeholder="Search products..." value="{{ request.GET.q|default:'' }}">
                    <button class="btn btn-outline-light" type="submit">Search</button>
                </form>
                
                <div class="navbar-nav ms-3">
                    {% if user.is_authenticated %}
                        <span class="nav-link text-light me-2">Hi, {{ user.username }}</span>
                        <!-- Cart Link -->
                        <a href="{% url 'core:cart_detail' %}" class="btn btn-outline-warning me-2">
                            ğŸ›’ Cart <span class="badge bg-warning text-dark">{{ cart_item_count|default:"0" }}</span>
                        </a>
                        <!-- Logout Form -->
                        <form action="{% url 'core:logout' %}" method="post" class="d-inline">
                            {% csrf_token %}
                            <button type="submit" class="btn btn-outline-secondary btn-sm">Logout</button>
                        </form>
                    {% else %}
                        <a class="nav-link" href="{% url 'core:login' %}">Login</a>
                        <a class="nav-link" href="{% url 'core:register' %}">Register</a>
                    {% endif %}
                </div>
            </div>
        </div>
    </nav>

    <div class="container">
        <!-- Page Content -->
        {% block content %}{% endblock %}
    </div>

    <footer class="py-4 mt-5 bg-light text-center">
        <p class="text-muted">Â© 2026 Online Shopping System Project</p>
    </footer>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>
==================== END FILE: core\templates\core\base.html ====================

==================== START FILE: core\templates\core\cart_detail.html ====================
{% extends 'core/base.html' %}

{% block content %}
<div class="row">
    <div class="col-12 mb-4">
        <h2 class="fw-bold">My Shopping Cart</h2>
    </div>

    {% if cart_items %}
    <!-- Cart Items List -->
    <div class="col-md-8">
        <div class="card shadow-sm border-0">
            <div class="card-header bg-white border-bottom">
                <h5 class="mb-0">Items ({{ cart_items.count }})</h5>
            </div>
            <div class="table-responsive">
                <table class="table table-hover align-middle mb-0">
                    <thead class="table-light">
                        <tr>
                            <th scope="col" class="ps-4">Product</th>
                            <th scope="col">Price</th>
                            <th scope="col">Quantity</th>
                            <th scope="col">Subtotal</th>
                            <th scope="col">Action</th>
                        </tr>
                    </thead>
                    <tbody>
                        {% for item in cart_items %}
                        <tr>
                            <td class="ps-4">
                                <div class="d-flex align-items-center">
                                    <!-- Product Image -->
                                    <a href="{% url 'core:product_detail' item.product.id %}">
                                        {% if item.product.images.first %}
                                            <img src="{{ item.product.images.first.image.url }}" class="rounded border" style="width: 60px; height: 60px; object-fit: cover;" alt="{{ item.product.name }}">
                                        {% else %}
                                            <div class="bg-secondary text-white rounded d-flex align-items-center justify-content-center" style="width: 60px; height: 60px; font-size: 12px;">No Image</div>
                                        {% endif %}
                                    </a>
                                    <!-- Product Name -->
                                    <div class="ms-3">
                                        <a href="{% url 'core:product_detail' item.product.id %}" class="text-decoration-none text-dark fw-bold">
                                            {{ item.product.name }}
                                        </a>
                                    </div>
                                </div>
                            </td>
                            <td>Â¥{{ item.product.price }}</td>
                            <td>
                                <span class="badge bg-light text-dark border">{{ item.quantity }}</span>
                            </td>
                            <td class="text-danger fw-bold">Â¥{{ item.subtotal }}</td>
                            <td>
                                <a href="{% url 'core:remove_from_cart' item.id %}" class="btn btn-outline-danger btn-sm" onclick="return confirm('Are you sure you want to remove this item?')">
                                    Remove
                                </a>
                            </td>
                        </tr>
                        {% endfor %}
                    </tbody>
                </table>
            </div>
        </div>
    </div>

    <!-- Checkout Panel -->
    <div class="col-md-4">
        <div class="card shadow-sm border-0">
            <div class="card-header bg-white border-bottom">
                <h5 class="mb-0">Order Summary</h5>
            </div>
            <div class="card-body">
                <div class="d-flex justify-content-between mb-3">
                    <span class="text-muted">Subtotal</span>
                    <span class="fw-bold">Â¥{{ total_price }}</span>
                </div>
                <hr>
                <div class="d-flex justify-content-between mb-4 align-items-center">
                    <span class="fs-5">Total:</span>
                    <span class="text-danger fs-3 fw-bold">Â¥{{ total_price }}</span>
                </div>
                
                <div class="d-grid gap-2">
                    <a href="{% url 'core:checkout' %}" class="btn btn-success btn-lg shadow-sm" onclick="return confirm('Confirm to checkout?')">
                        Checkout Now
                    </a>
                    <a href="{% url 'core:product_list' %}" class="btn btn-outline-secondary">
                        Continue Shopping
                    </a>
                </div>
            </div>
        </div>
    </div>

    {% else %}
    <!-- Empty Cart Message -->
    <div class="col-12 text-center py-5">
        <div class="mb-4">
            <span style="font-size: 4rem;">ğŸ›’</span>
        </div>
        <h3 class="text-muted">Your cart is empty</h3>
        <p class="text-muted mb-4">Looks like you haven't added any items to the cart yet.</p>
        <a href="{% url 'core:product_list' %}" class="btn btn-primary btn-lg px-5">Start Shopping</a>
    </div>
    {% endif %}
</div>
{% endblock %}
==================== END FILE: core\templates\core\cart_detail.html ====================

==================== START FILE: core\templates\core\login.html ====================
{% extends 'core/base.html' %}

{% block content %}
<div class="row justify-content-center">
    <div class="col-md-4">
        <div class="card shadow-sm mt-5">
            <div class="card-body">
                <h3 class="card-title text-center mb-4">Login</h3>
                <form method="post">
                    {% csrf_token %}
                    {% for field in form %}
                    <div class="mb-3">
                        <label class="form-label">{{ field.label }}</label>
                        {{ field }}
                        {% if field.errors %}
                        <div class="text-danger small">{{ field.errors.0 }}</div>
                        {% endif %}
                    </div>
                    {% endfor %}
                    <button type="submit" class="btn btn-primary w-100">Login</button>
                </form>
                <div class="text-center mt-3">
                    <p>Don't have an account? <a href="{% url 'core:register' %}">Register here</a></p>
                </div>
            </div>
        </div>
    </div>
</div>
<script>
    var inputs = document.querySelectorAll('input');
    inputs.forEach(function(input){
        input.classList.add('form-control');
    });
</script>
{% endblock %}
==================== END FILE: core\templates\core\login.html ====================

==================== START FILE: core\templates\core\order_detail.html ====================
{% extends 'core/base.html' %}

{% block content %}
<div class="card shadow">
    <div class="card-header bg-dark text-white d-flex justify-content-between align-items-center">
        <span>Order #{{ order.id }}</span>
        <span class="badge bg-warning text-dark">{{ order.get_status_display }}</span>
    </div>
    <div class="card-body">
        <div class="row mb-4">
            <div class="col-md-6">
                <h5 class="text-muted">Shipping Address</h5>
                <p>{{ order.shipping_address_snapshot }}</p>
            </div>
            <div class="col-md-6 text-end">
                <h5 class="text-muted">Order Date</h5>
                <p>{{ order.created_at|date:"Y-m-d H:i:s" }}</p>
            </div>
        </div>

        <h5 class="mb-3">Order Items</h5>
        <table class="table table-bordered">
            <thead class="table-light">
                <tr>
                    <th>Product Name</th>
                    <th>Unit Price</th>
                    <th>Qty</th>
                    <th>Subtotal</th>
                </tr>
            </thead>
            <tbody>
                {% for item in order.items.all %}
                <tr>
                    <td>{{ item.product_name_snapshot }}</td>
                    <td>Â¥{{ item.unit_price_snapshot }}</td>
                    <td>{{ item.quantity }}</td>
                    <td>Â¥{{ item.unit_price_snapshot|default:0 }} * {{ item.quantity }}</td>
                </tr>
                {% endfor %}
            </tbody>
            <tfoot>
                <tr>
                    <td colspan="3" class="text-end fw-bold">Grand Total:</td>
                    <td class="text-danger fw-bold fs-4">Â¥{{ order.total_amount }}</td>
                </tr>
            </tfoot>
        </table>

        <div class="text-center mt-4">
            <a href="{% url 'core:order_list' %}" class="btn btn-outline-secondary">Back to Orders</a>
            <a href="{% url 'core:product_list' %}" class="btn btn-primary">Continue Shopping</a>
        </div>
    </div>
</div>
{% endblock %}
==================== END FILE: core\templates\core\order_detail.html ====================

==================== START FILE: core\templates\core\order_list.html ====================
{% extends 'core/base.html' %}

{% block content %}
<h2 class="mb-4">My Order History</h2>

<div class="list-group">
    {% for order in orders %}
    <a href="{% url 'core:order_detail' order.id %}" class="list-group-item list-group-item-action" aria-current="true">
        <div class="d-flex w-100 justify-content-between">
            <h5 class="mb-1">Order #{{ order.id }}</h5>
            <small class="text-muted">{{ order.created_at|date:"Y-m-d H:i" }}</small>
        </div>
        <div class="d-flex justify-content-between align-items-center mt-2">
            <div>
                <span class="badge bg-primary rounded-pill">{{ order.get_status_display }}</span>
                <span class="ms-2 text-muted">{{ order.items.count }} items</span>
            </div>
            <strong class="text-danger fs-5">Â¥{{ order.total_amount }}</strong>
        </div>
    </a>
    {% empty %}
    <div class="alert alert-warning">You have no orders yet.</div>
    {% endfor %}
</div>
{% endblock %}
==================== END FILE: core\templates\core\order_list.html ====================

==================== START FILE: core\templates\core\product_detail.html ====================
{% extends 'core/base.html' %}

{% block content %}
<div class="row">
    <!-- Left: Product Images (Block B1) -->
    <div class="col-md-6">
        {% if product.images.all %}
            <div id="productCarousel" class="carousel slide" data-bs-ride="carousel">
                <div class="carousel-inner">
                    {% for img in product.images.all %}
                    <div class="carousel-item {% if forloop.first %}active{% endif %}">
                        <img src="{{ img.image.url }}" class="d-block w-100 rounded" alt="{{ product.name }}">
                    </div>
                    {% endfor %}
                </div>
                <button class="carousel-control-prev" type="button" data-bs-target="#productCarousel" data-bs-slide="prev">
                    <span class="carousel-control-prev-icon" aria-hidden="true"></span>
                </button>
                <button class="carousel-control-next" type="button" data-bs-target="#productCarousel" data-bs-slide="next">
                    <span class="carousel-control-next-icon" aria-hidden="true"></span>
                </button>
            </div>
            
            <!-- Thumbnails -->
            <div class="d-flex mt-2">
                {% for img in product.images.all %}
                <img src="{{ img.image.url }}" 
                     class="img-thumbnail me-2" 
                     style="width: 80px; height: 80px; object-fit: cover; cursor: pointer;" 
                     data-bs-target="#productCarousel" 
                     data-bs-slide-to="{{ forloop.counter0 }}"
                     aria-label="Slide {{ forloop.counter }}">
                {% endfor %}
            </div>
        {% else %}
            <div class="alert alert-secondary text-center py-5">No Image Available</div>
        {% endif %}
    </div>

    <!-- Right: Product Info & Purchase (Block A6 & A7) -->
    <div class="col-md-6">
        <h1 class="mb-3 fw-bold">{{ product.name }}</h1>
        <h3 class="text-danger mb-4">Â¥{{ product.price }}</h3>
        
        <div class="card mb-4 shadow-sm border-0 bg-light">
            <div class="card-body">
                <p class="mb-3">
                    <strong>Availability:</strong> 
                    {% if product.stock_quantity > 0 %}
                        <span class="text-success">In Stock ({{ product.stock_quantity }})</span>
                    {% else %}
                        <span class="text-danger">Out of Stock</span>
                    {% endif %}
                </p>
                
                <!-- Add to Cart Form -->
                <form action="{% url 'core:add_to_cart' product.id %}" method="post">
                    {% csrf_token %}
                    <div class="row g-3 align-items-center mb-3">
                        <div class="col-auto">
                            <label class="col-form-label fw-bold">Quantity:</label>
                        </div>
                        <div class="col-auto">
                            <input type="number" name="quantity" class="form-control" value="1" min="1" max="{{ product.stock_quantity }}" style="width: 100px;">
                        </div>
                    </div>
                    
                    {% if user.is_authenticated %}
                        {% if product.stock_quantity > 0 %}
                            <button type="submit" class="btn btn-lg btn-warning w-100 fw-bold">
                                <i class="bi bi-cart-plus"></i> Add to Cart
                            </button>
                        {% else %}
                            <button type="button" class="btn btn-lg btn-secondary w-100" disabled>Sold Out</button>
                        {% endif %}
                    {% else %}
                        <a href="{% url 'core:login' %}?next={{ request.path }}" class="btn btn-lg btn-primary w-100">
                            Login to Buy
                        </a>
                    {% endif %}
                </form>
                
            </div>
        </div>

        <!-- Description (Block C1) -->
        <div class="mt-4">
            <h5 class="border-bottom pb-2">Description</h5>
            <div class="product-description mt-3">
                {{ product.description_html|safe }}
            </div>
        </div>

        <!-- Attributes (Block C2) -->
        {% if product.attributes.exists %}
        <div class="mt-4">
            <h5 class="border-bottom pb-2">Specifications</h5>
            <table class="table table-striped mt-2">
                {% for attr in product.attributes.all %}
                <tr>
                    <th scope="row" class="text-secondary" style="width: 150px;">{{ attr.attribute_name }}</th>
                    <td>{{ attr.attribute_value }}</td>
                </tr>
                {% endfor %}
            </table>
        </div>
        {% endif %}
    </div>
</div>
{% endblock %}
==================== END FILE: core\templates\core\product_detail.html ====================

==================== START FILE: core\templates\core\product_list.html ====================
{% extends 'core/base.html' %}

{% block content %}
<div class="row">
    <!-- å·¦ä¾§åˆ†ç±» (Block C3) -->
    <div class="col-md-3">
        <div class="list-group">
            <!-- åˆ¤æ–­å½“å‰æ˜¯å¦æœ‰åˆ†ç±»å‚æ•°ï¼Œå¦‚æœæ²¡æœ‰ï¼Œ"æ‰€æœ‰åˆ†ç±»"é«˜äº® -->
            <a href="{% url 'core:product_list' %}" class="list-group-item list-group-item-action {% if not request.GET.category %}active{% endif %}">
                All Categories
            </a>
            {% for cat in categories %}
            <!-- ç‚¹å‡»åˆ†ç±»æ—¶ï¼Œä¿ç•™å½“å‰çš„æœç´¢å…³é”®è¯ q -->
            <a href="?category={{ cat.id }}{% if request.GET.q %}&q={{ request.GET.q }}{% endif %}" 
               class="list-group-item list-group-item-action {% if request.GET.category|add:'0' == cat.id %}active{% endif %}">
                {{ cat.name }}
            </a>
            {% endfor %}
        </div>
    </div>

    <!-- å³ä¾§å•†å“åˆ—è¡¨ (Block A3) -->
    <div class="col-md-9">
        <div class="row">
            {% for product in products %}
            <div class="col-md-4 mb-4">
                <div class="card h-100 shadow-sm">
                    <!-- æ˜¾ç¤ºç¬¬ä¸€å¼ å›¾ç‰‡ (Block B1) -->
                    {% if product.images.first %}
                        <img src="{{ product.images.first.image.url }}" class="card-img-top" style="height: 200px; object-fit: cover;" alt="{{ product.name }}">
                    {% else %}
                        <div class="bg-secondary text-white d-flex align-items-center justify-content-center" style="height: 200px;">No Image</div>
                    {% endif %}
                    
                    <div class="card-body d-flex flex-column">
                        <h5 class="card-title">{{ product.name }}</h5>
                        <p class="card-text text-danger fw-bold">Â¥{{ product.price }}</p>
                        <!-- mt-auto è®©æŒ‰é’®å§‹ç»ˆæ²‰åº•ï¼Œä¿æŒå¡ç‰‡é«˜åº¦æ•´é½ -->
                        <a href="{% url 'core:product_detail' product.id %}" class="btn btn-primary w-100 mt-auto">View Details</a>
                    </div>
                </div>
            </div>
            {% empty %}
                <div class="alert alert-warning">No products found.</div>
            {% endfor %}
        </div>

        <!-- ========================================== -->
        <!-- Block A5: åˆ†é¡µæ§ä»¶ (Pagination Controls) -->
        <!-- ========================================== -->
        {% if products.has_other_pages %}
        <nav aria-label="Page navigation" class="mt-4">
            <ul class="pagination justify-content-center">
                
                <!-- ä¸Šä¸€é¡µæŒ‰é’® -->
                {% if products.has_previous %}
                <li class="page-item">
                    <a class="page-link" href="?page={{ products.previous_page_number }}{% if request.GET.q %}&q={{ request.GET.q }}{% endif %}{% if request.GET.category %}&category={{ request.GET.category }}{% endif %}">Previous</a>
                </li>
                {% else %}
                <li class="page-item disabled"><span class="page-link">Previous</span></li>
                {% endif %}

                <!-- é¡µç å¾ªç¯ -->
                {% for i in products.paginator.page_range %}
                    {% if products.number == i %}
                        <li class="page-item active"><span class="page-link">{{ i }}</span></li>
                    {% else %}
                        <li class="page-item">
                            <a class="page-link" href="?page={{ i }}{% if request.GET.q %}&q={{ request.GET.q }}{% endif %}{% if request.GET.category %}&category={{ request.GET.category }}{% endif %}">{{ i }}</a>
                        </li>
                    {% endif %}
                {% endfor %}

                <!-- ä¸‹ä¸€é¡µæŒ‰é’® -->
                {% if products.has_next %}
                <li class="page-item">
                    <a class="page-link" href="?page={{ products.next_page_number }}{% if request.GET.q %}&q={{ request.GET.q }}{% endif %}{% if request.GET.category %}&category={{ request.GET.category }}{% endif %}">Next</a>
                </li>
                {% else %}
                <li class="page-item disabled"><span class="page-link">Next</span></li>
                {% endif %}
            </ul>
        </nav>
        {% endif %}
        
    </div>
</div>
{% endblock %}
==================== END FILE: core\templates\core\product_list.html ====================

==================== START FILE: core\templates\core\register.html ====================
{% extends 'core/base.html' %}

{% block content %}
<div class="row justify-content-center">
    <div class="col-md-4">
        <div class="card shadow-sm mt-5">
            <div class="card-body">
                <h3 class="card-title text-center mb-4">Create Account</h3>
                <form method="post">
                    {% csrf_token %}
                    {% for field in form %}
                    <div class="mb-3">
                        <label class="form-label">{{ field.label }}</label>
                        {{ field }}
                        <div class="text-muted small">{{ field.help_text }}</div>
                        {% if field.errors %}
                        <div class="text-danger small">{{ field.errors.0 }}</div>
                        {% endif %}
                    </div>
                    {% endfor %}
                    <button type="submit" class="btn btn-success w-100">Register</button>
                </form>
                <div class="text-center mt-3">
                    <p>Already have an account? <a href="{% url 'core:login' %}">Login here</a></p>
                </div>
            </div>
        </div>
    </div>
</div>
<script>
    var inputs = document.querySelectorAll('input');
    inputs.forEach(function(input){
        input.classList.add('form-control');
    });
</script>
{% endblock %}
==================== END FILE: core\templates\core\register.html ====================

==================== START FILE: my_shop\asgi.py ====================
"""
ASGI config for my_shop project.

It exposes the ASGI callable as a module-level variable named ``application``.

For more information on this file, see
https://docs.djangoproject.com/en/5.2/howto/deployment/asgi/
"""

import os

from django.core.asgi import get_asgi_application

os.environ.setdefault('DJANGO_SETTINGS_MODULE', 'my_shop.settings')

application = get_asgi_application()

==================== END FILE: my_shop\asgi.py ====================

==================== START FILE: my_shop\settings.py ====================
"""
Django settings for my_shop project.

Generated by 'django-admin startproject' using Django 5.2.10.

For more information on this file, see
https://docs.djangoproject.com/en/5.2/topics/settings/

For the full list of settings and their values, see
https://docs.djangoproject.com/en/5.2/ref/settings/
"""

from pathlib import Path

# Build paths inside the project like this: BASE_DIR / 'subdir'.
BASE_DIR = Path(__file__).resolve().parent.parent


# Quick-start development settings - unsuitable for production
# See https://docs.djangoproject.com/en/5.2/howto/deployment/checklist/

# SECURITY WARNING: keep the secret key used in production secret!
SECRET_KEY = 'django-insecure-z$90$k)hxjvtv0y+(+u!x#cpa(hfclg$=0r@@-$h#ro^$(%t-b'

# SECURITY WARNING: don't run with debug turned on in production!
DEBUG = True

ALLOWED_HOSTS = []


# Application definition

INSTALLED_APPS = [
    'core',
    'django.contrib.admin',
    'django.contrib.auth',
    'django.contrib.contenttypes',
    'django.contrib.sessions',
    'django.contrib.messages',
    'django.contrib.staticfiles',
]

MIDDLEWARE = [
    'django.middleware.security.SecurityMiddleware',
    'django.contrib.sessions.middleware.SessionMiddleware',
    'django.middleware.common.CommonMiddleware',
    'django.middleware.csrf.CsrfViewMiddleware',
    'django.contrib.auth.middleware.AuthenticationMiddleware',
    'django.contrib.messages.middleware.MessageMiddleware',
    'django.middleware.clickjacking.XFrameOptionsMiddleware',
]

ROOT_URLCONF = 'my_shop.urls'

TEMPLATES = [
    {
        'BACKEND': 'django.template.backends.django.DjangoTemplates',
        'DIRS': [],
        'APP_DIRS': True,
        'OPTIONS': {
            'context_processors': [
                'django.template.context_processors.request',
                'django.contrib.auth.context_processors.auth',
                'django.contrib.messages.context_processors.messages',
                'core.context_processors.cart_status',
            ],
        },
    },
]

WSGI_APPLICATION = 'my_shop.wsgi.application'


# Database
# https://docs.djangoproject.com/en/5.2/ref/settings/#databases

DATABASES = {
    'default': {
        'ENGINE': 'django.db.backends.sqlite3',
        'NAME': BASE_DIR / 'db.sqlite3',
    }
}


# Password validation
# https://docs.djangoproject.com/en/5.2/ref/settings/#auth-password-validators

AUTH_PASSWORD_VALIDATORS = [
    {
        'NAME': 'django.contrib.auth.password_validation.UserAttributeSimilarityValidator',
    },
    {
        'NAME': 'django.contrib.auth.password_validation.MinimumLengthValidator',
    },
    {
        'NAME': 'django.contrib.auth.password_validation.CommonPasswordValidator',
    },
    {
        'NAME': 'django.contrib.auth.password_validation.NumericPasswordValidator',
    },
]


# Internationalization
# https://docs.djangoproject.com/en/5.2/topics/i18n/

LANGUAGE_CODE = 'en-us'

TIME_ZONE = 'UTC'

USE_I18N = True

USE_TZ = True


# Static files (CSS, JavaScript, Images)
# https://docs.djangoproject.com/en/5.2/howto/static-files/

STATIC_URL = 'static/'

# Default primary key field type
# https://docs.djangoproject.com/en/5.2/ref/settings/#default-auto-field

DEFAULT_AUTO_FIELD = 'django.db.models.BigAutoField'
# æŒ‡å®šè‡ªå®šä¹‰ç”¨æˆ·æ¨¡å‹
AUTH_USER_MODEL = 'core.User'

# é…ç½®åª’ä½“æ–‡ä»¶ï¼ˆå›¾ç‰‡ï¼‰å­˜å‚¨è·¯å¾„
import os
MEDIA_URL = '/media/'
MEDIA_ROOT = os.path.join(BASE_DIR, 'media')
==================== END FILE: my_shop\settings.py ====================

==================== START FILE: my_shop\urls.py ====================
"""
URL configuration for my_shop project.

The `urlpatterns` list routes URLs to views. For more information please see:
    https://docs.djangoproject.com/en/5.2/topics/http/urls/
Examples:
Function views
    1. Add an import:  from my_app import views
    2. Add a URL to urlpatterns:  path('', views.home, name='home')
Class-based views
    1. Add an import:  from other_app.views import Home
    2. Add a URL to urlpatterns:  path('', Home.as_view(), name='home')
Including another URLconf
    1. Import the include() function: from django.urls import include, path
    2. Add a URL to urlpatterns:  path('blog/', include('blog.urls'))
"""
from django.contrib import admin
from django.urls import path, include
from django.conf import settings
from django.conf.urls.static import static

urlpatterns = [
    path('admin/', admin.site.urls),
    # æŠŠ core åº”ç”¨çš„è·¯ç”±åŒ…å«è¿›æ¥
    path('', include('core.urls')), 
]

# é…ç½®å›¾ç‰‡æ–‡ä»¶çš„è®¿é—®è·¯å¾„ (Block B1 å¿…é¡»)
if settings.DEBUG:
    urlpatterns += static(settings.MEDIA_URL, document_root=settings.MEDIA_ROOT)

==================== END FILE: my_shop\urls.py ====================

==================== START FILE: my_shop\wsgi.py ====================
"""
WSGI config for my_shop project.

It exposes the WSGI callable as a module-level variable named ``application``.

For more information on this file, see
https://docs.djangoproject.com/en/5.2/howto/deployment/wsgi/
"""

import os

from django.core.wsgi import get_wsgi_application

os.environ.setdefault('DJANGO_SETTINGS_MODULE', 'my_shop.settings')

application = get_wsgi_application()

==================== END FILE: my_shop\wsgi.py ====================

==================== START FILE: my_shop\__init__.py ====================

==================== END FILE: my_shop\__init__.py ====================
